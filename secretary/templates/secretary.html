{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secretary</title>
    <link rel="icon" type="image/png" href="https://swd.vit.edu/img/swdlogo3.png">

    <!-- font awesome cdn link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css">

    <!-- custom css file link  -->
    <link rel="stylesheet" href="{% static 'style.css'%}">
    <link rel="stylesheet" href="{% static 'style_secretary.css' %}">
    
    <style>
        .activity-select {
        display: block;
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 20px;
        font-size: 16px;
        }

        .options-section {
        text-align: center;
        }

        .dashboard-btn {
        display: block;
        width: 100%;
        background-color: #c9df8a; 
        color: #fff;
        border: none;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 5px;
        font-size: 16px;
        text-align: center;
        cursor: pointer;
        }

        .dashboard-btn:hover {
        background-color: #234d20;
        }

        /* .hidden {
        display: none;
        } */

        .time-display
        {
            border: 1px solid #ced4da;width: 80%; padding-left: 4%;padding-right: 57%;
        }

        @media(max-width:1000px){
        .time-display
        {
            color: red;
            border: 1px solid #ced4da;width: 80%; padding-left: 4%;padding-right: 15%;
        }}
        @media(max-width:500px){
        .time-display
        {
            color: red;
            border: 1px solid #ced4da;width: 80%; padding-left: 4%;padding-right: 1%;
        }}
    </style>

</head>

<body>

    <header class="header">

        <section class="flex">

            <a href="" class="logo">Hello, {{user.last_name}} !!</a>

            <div class="icons">
                <div id="menu-btn" class="fas fa-bars"></div>
            </div>

            <div class="profile">
                <img src="{% if user.profile.image %}{{ user.profile.image.url }}{% else %}{% static 'images/default-profile.jpg' %}{% endif %}" class="image" alt="user-image">
                <h3 class="name"></h3>
                <p class="role"></p>
                <a href="{% url 'profile'%}" class="btn">view profile</a>
                <div class="flex-btn">
                    <a href="{% url 'userlogin'%}" class="option-btn">login</a>
                    <a href="{% url 'userlogin'%}" class="option-btn">register</a>
                </div>
            </div>

        </section>

    </header>

    <div class="side-bar">

        <div id="close-btn">
            <i class="fas fa-times"></i>
        </div>

        <div class="profile">
            <img src="{% if user.profile.image %}{{ user.profile.image.url }}{% else %}{% static 'images/default-profile.jpg' %}{% endif %}" class="image" alt="">
            <h3 class="name"></h3>
            <p class="role"></p>
            <a href="{% url 'profile'%}" class="btn">view profile</a>
        </div>

        <nav class="navbar">
            <a href="" id="D_content"><i class="fas fa-home"></i><span>Home</span></a>
            <a href="secretary.html" id="eventsLink"><i class="fas fa-calendar-alt"></i><span>Add Events</span></a>
            <a href="#" id="attendanceLink"><i class="fas fa-user-check"></i><span>Attendance</span></a>
            <a href="contact.html" id="contact"><i class="fas fa-headset"></i><span>Contact us</span></a>
            <form id="logoutForm" method="POST" action="{% url 'logout_view' %}">
                {% csrf_token %}
                <button type="submit" id="logoutButton" class="logout-btn" style="position: absolute; top: 85%; left: 30%;">
                    <i class="fas fa-sign-out-alt" style="margin-right: 8px;"></i> Logout
                </button>
            </form>
        </nav>

    </div>

    <section class="courses">
        <div class="box-container">
            <div class="wrapper">
            
                <!-- Main Content -->
                <div id="mainContent" class="content">
                    <header id="head">
                        Secretary Dashboard
                    </header>
                    <!-- Dashboard Content (Default) -->
                    <div id="dashboardContent" class="content-section">
                        <div class="D_content">
                            <h1 style="font-size: 19px; font-weight: bold;"  >Welcome To SW&D's Smart Attendance System</h1>
                            <p style="font-size: 16px;">We work for the betterment<br>of the society</p>
                        </div>
                        <br><br>
                        <div id="chooseActivity" class="content hidden">
                            {% if secretary.registered_academic_year == CURR_YEAR and secretary.registered_semester == CURR_SEM %}
                                {% if not secretary.activity %}
                                    <h2 class="dashboard-title" style="font-size: 19px;">Choose Social Services</h2>
                                    <form method="POST" action="{% url 'secretary' %}">
                                        {% csrf_token %}
                                        <select id="activitySelect" class="activity-select" name="activity" required>
                                            {% if socialServices %}
                                                <option value="">Select an activity</option>
                                                {% for activity in socialServices %}
                                                    <option value="{{ activity }}">{{ activity }}</option>
                                                {% endfor %}
                                            {% else %}
                                                <option value="">No activities available</option>
                                            {% endif %}
                                        </select>
                                        <button class="dashboard-btn" type="submit">Allot Activity</button>
                                    </form>
                                {% else %}
                                    <div>
                                        <p style="font-size: 16px;">You have already chosen {{ secretary.activity }}</p>
                                    </div>
                                {% endif %}
                            {% else %}
                                <div>
                                    <p style="font-size: 16px;">Cannot choose activity for the current semester</p>
                                </div>
                            {% endif %}
                            </div>

                            <br><br>

                            <div id="chooseActivity" class="content hidden"> 
                                {% if secretary.registered_academic_year == CURR_YEAR and secretary.registered_semester == CURR_SEM %}
                                    {% if not secretary.flagshipEvent %}
                                        <h2 class="dashboard-title" style="font-size: 19px;">Choose Flagship Event</h2>
                                        <form method="POST" action="{% url 'secretary' %}">
                                            {% csrf_token %}
                                            <select id="activitySelect" class="activity-select" name="flagship" required>
                                                {% if flagships %}
                                                    <option value="">Select an activity</option>
                                                    {% for activity in flagships %}
                                                        <option value="{{ activity }}">{{ activity }}</option>
                                                    {% endfor %}
                                                {% else %}
                                                    <option value="">No activities available</option>
                                                {% endif %}
                                            </select>
                                            <button class="dashboard-btn" type="submit">Allot Activity</button>
                                        </form>
                                    {% else %}
                                        <div>
                                            <p style="font-size: 16px;">You have already chosen {{ secretary.flagshipEvent }}</p>
                                        </div>
                                    {% endif %}
                                {% else %}
                                    <div>
                                        <p>Cannot choose activity for the current semester</p>
                                    </div>
                                {% endif %}
                                </div>
                    </div>
                    
                    <div style="padding-left: 18%;">
                        <!-- Add Event Form -->
                        <div id="markAttendanceContent" class="content-section" style="display: none; margin-top:5%">
                        <form method="POST" action="{% url 'add_activity' %}">
                            {% csrf_token %}
                            <div class="dashboard-item;">
                                <h2 style="font-weight: bold; font-size: 19px;" >Name of Activity</h2>
                                <select style="max-width: 80%;" id="activitySelect" class="activity-select" name="activity" required>
                                    {% if secretary.registered_academic_year == CURR_YEAR and secretary.registered_semester == CURR_SEM %}
                                        {% if secretary.activity or secretary.flagshipEvent %}
                                            <option value="">Select an activity</option>
                                            {% if secretary.activity %}
                                                <option value="{{ secretary.activity }}">{{ secretary.activity }}</option>
                                            {% endif %}
                                            {% if secretary.flagshipEvent %}
                                                <option value="{{ secretary.flagshipEvent }}">{{ secretary.flagshipEvent }}</option>
                                            {% endif %}
                                        {% else %}
                                            <option value="">No activities to select</option>
                                        {% endif %}
                                    {% else %}
                                        <option value="">No activities to select</option>
                                    {% endif %}
                                </select>
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Mode of Event</h2>
                                    <!-- <div style="width: 15%; margin: 0 auto; display: flex; align-items: left; justify-content: ;border: none;"> -->
                                    <!-- <input type="date" id="activity-datetime" style="border: none; outline: none;" name="event-date"> -->
                                    <select style="max-width: 80%;" id="activitySelect" class="activity-select" name="mode" required>
                                        <option value="">Select mode of activity</option>
                                        <option value="online">Online</option>
                                        <option value="offline">Offline</option>
                                    </select>
                                    <!-- </div> -->
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Venue of Event</h2>
                                <input type="text" id="map-link" placeholder="Enter Venue" name="venue">
                            </div>
 
                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Date of Event</h2>
                                <div class="time-display">
                                    <!-- <div style="width: 15%; margin: 0 auto; display: flex; align-items: left; justify-content: ;border: none;"> -->
                                    <input type="date" id="activity-datetime" style="border: none; outline: none;" name="event-date">
                                    <!-- </div> -->
                                </div>
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Start Time of Event</h2>
                                <div class="time-display">
                                    <!-- <div style="width: 15%; margin: 0 auto; display: flex; align-items: left; justify-content: ;border: none;"> -->
                                    <input type="time" id="activity-datetime" style="border: none; outline: none;" name="start-time">
                                    <!-- </div> -->
                                </div>
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >End Time of Event</h2>
                                <div class="time-display">
                                    <!-- <div style="width: 15%; margin: 0 auto; display: flex; align-items: left; justify-content: ;border: none;"> -->
                                    <input type="time" id="activity-datetime" style="border: none; outline: none;" name="end-time">
                                    <!-- </div> -->
                                </div>
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Map Link</h2>
                                <input type="url" id="map-link" placeholder="Enter map link" name="map-link">
                            </div>

                            <div class="dashboard-item">
                                <h2  style="font-weight: bold; font-size: 19px;" >Description</h2>
                                <textarea id="activity-description" rows="4"
                                    placeholder="Enter activity description" name="description"></textarea>
                            </div>

                            <div class="dashboard-item btns" style="max-width: 80%;">
                                <button   style="font-weight: bold; font-size: 16px;" id="update-status-btn">Update the Status</button>
                            </div>
                        </form>
                        </div>

                        <!-- Download Attendance Form -->
                        <div id="downloadAttendanceContent" class="content-section" style="display: none; margin-top:5%">
                            <form method="POST" action="{% url 'download_attendance' %}">
                                {% csrf_token %}
                                <div class="dashboard-item">
                                    <h2 style="font-weight: bold; font-size: 19px;" >Download Attendance</h2>
                                    <select id="event-name" class="activity-select" name="event-name"style=" max-width: 80%;" required>
                                    {% if secretary.registered_academic_year == CURR_YEAR and secretary.registered_semester == CURR_SEM %}
                                        {% if secretary.activity or secretary.flagshipEvent %}
                                        <option value="">Select an activity</option>
                                        {% if secretary.activity %}
                                            <option value="{{ secretary.activity }}">{{ secretary.activity }}</option>
                                        {% endif %}
                                        {% if secretary.flagshipEvent %}
                                            <option value="{{ secretary.flagshipEvent }}">{{ secretary.flagshipEvent }}</option>
                                        {% endif %}
                                    {% else %}
                                        <option value="">No activities to select</option>
                                    {% endif %}
                                    {% else %}
                                        <option value="">No activities to select</option>
                                    {% endif %}
                                    </select>   
                                </div>
                                <div class="dashboard-item">
                                    <button type="submit" style="max-width: 80%; font-size: 19px;">Download</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- Contact Us Section -->
                    <div id="contactUsContent" class="content-section" style="display: none;">
                        <section class="contact">
                            <div  id="how" class="box-container" style="padding-top: 5%;">
                                <div class="box">
                                    <i class="fas fa-phone"></i>
                                    <h3>Phone Number</h3>
                                    <a href="tel:8010897017">+91 80108 97017</a>
                                    <a href="tel:9168151957">+91 91681 51957</a>
                                </div>
                  
                                <div class="box">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <h3>Office Address</h3>
                                    <a href="https://www.google.com/maps/dir//Vishwakarma+Institute+of+Technology+(VIT),+VISHWAKARMA+INSTITUTE+OF+TECHNOLOGY+VIT,+Bibwewadi,+Pune,+Maharashtra+411037/data=!4m6!4m5!1m1!4e2!1m2!1m1!1s0x3bc2ea950f616219:0x321bdae2cea9f064?sa=X&ved=1t:57443&ictx=111">VISHWAKARMA INSTITUTE OF TECHNOLOGY, Upper Indira Nagar, Bibwewadi, Pune, Maharashtra 411037</a>
                                </div>

                                <div class="box">
                                    <i class="fas fa-envelope"></i>
                                    <h3>Email Address</h3>
                                    <a href="mailto:vitswd@vit.edu">vitswd@vit.edu</a>
                                    {% comment %} <a href="mailto:JDGSNKFD@gmail.com">vitswd@vit.edu</a> {% endcomment %}
                                </div>
                  
                                
                            </div>
                        </section>
                     </div>
                </div>
            </div>
        </div>
        <div id="notification" class="notification">Logged out successfully!</div>

        <!-- JavaScript for Sidebar Toggle -->
        <script>

            // Add event functions
            document.addEventListener('DOMContentLoaded', () => {
                // Reference to sections
                const dashboardContent = document.getElementById("dashboardContent");
                const markAttendanceContent = document.getElementById("markAttendanceContent");
                const downloadAttendanceContent = document.getElementById("downloadAttendanceContent");
                const contactUsContent = document.getElementById("contactUsContent");

                // Links for navigation
                const dashboardLink = document.getElementById("dashboardLink");
                const attendanceLink = document.getElementById("attendanceLink");
                const eventsLink = document.getElementById("eventsLink");
                const contactLink = document.getElementById("contact");

                // Function to show content sections
                function showContent(contentToShow) {
                    // Hide all sections
                    dashboardContent.style.display = "none";
                    markAttendanceContent.style.display = "none";
                    downloadAttendanceContent.style.display = "none";
                    contactUsContent.style.display = "none";

                    // Show only the selected section
                    contentToShow.style.display = "block";
                }

                // Event listener for the Contact Us link
                contactLink.addEventListener("click", (e) => {
                    e.preventDefault();
                    showContent(contactUsContent);
                });

                // Event listeners for other links
                dashboardLink.addEventListener("click", (e) => {
                    e.preventDefault();
                    showContent(dashboardContent);
                });

                attendanceLink.addEventListener("click", (e) => {
                    e.preventDefault();
                    showContent(downloadAttendanceContent);
                });

                eventsLink.addEventListener("click", (e) => {
                    e.preventDefault();
                    showContent(markAttendanceContent);
                });

                // Show dashboard content by default
                showContent(dashboardContent);
            });




            // Add attendance functions

            const attendanceLink = document.getElementById("attendanceLink");

            attendanceLink.addEventListener("click", (e) => {
                e.preventDefault();
                showContent(downloadAttendanceContent);
            });

            eventsLink.addEventListener("click", (e) => {
                e.preventDefault();
                showContent(markAttendanceContent);
            });

            function showContent(contentToShow) {
                dashboardContent.style.display = "none";
                markAttendanceContent.style.display = "none";
                downloadAttendanceContent.style.display = "none";
                contentToShow.style.display = "block";
                contactUsContent.style.display = "none";
            }
        </script>


        <script>
            // Sidebar Toggle Functionality
            let sideBar = document.querySelector('.side-bar');
            let menuBtn = document.getElementById('menu-btn');
            let closeBtn = document.getElementById('close-btn');
            let body = document.body;

            // Toggle Sidebar on Menu Button Click
            menuBtn?.addEventListener('click', () => {
                sideBar.classList.toggle('active'); // Show/hide sidebar
                body.classList.toggle('active'); // Adjust main content
            });

            // Close Sidebar on Close Button Click
            closeBtn?.addEventListener('click', () => {
                sideBar.classList.remove('active'); // Hide sidebar
                body.classList.remove('active'); // Reset main content
            });

            // Close Sidebar when window is resized (optional, to handle desktop/mobile transitions)
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1200) {
                    sideBar.classList.remove('active');
                    body.classList.remove('active');
                }
            });

            document.getElementById('logoutButton').addEventListener('click', function () {
                e.preventDefault(); 
                const notification = document.getElementById('notification');
                notification.classList.add('show');
    
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
    
                setTimeout(() => {
                    document.getElementById('logoutForm').submit(); 
                }, 1000);
            });

        </script>

        <script>
            function generateQR() {
                const activity = document.getElementById('activitySelect').value;
                if (activity) {
                    // Add the generate a QR code here
                    // For this example, we're just showing the QR code section
                    document.getElementById('qrCodeSection').style.display = 'block';
                    // You would replace this with actual QR code generation
                    // document.getElementById('qrCodeImage').src = /api/placeholder/200/200?text=${activity};
                } else {
                    alert('Please select an activity first.');
                }
            }

            function resetSelection() {
                document.getElementById('activitySelect').value = '';
                document.getElementById('qrCodeSection').style.display = 'none';
            }

            eventsLink.addEventListener("click", (e) => {
                e.preventDefault();
                showContent(markAttendanceContent);
            });


        </script>

        </div>

    </section>
    <!-- custom js file link  -->
    <script src="js/script.js"></script>




</body>

</html>